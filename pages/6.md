[Top](../README.md)
# データベース
## データベースの基礎
- データベースの種類
  - 階層型データベース
    - レコード同士が親子関係をもつ
    - 子レコードに対し、親レコードは１つ
  - 網型データベース
    - 子レコードに対し、親レコードは複数
  - 関係データベース
    - レコード間に関係はない
    - 値の一致により、テーブル間をつなぐ
- データベースの設計
  1. 概念設計
      - 概念データモデルの作成（E-Rモデル、UMLクラス図）
      - データ分析（標準化と正規化） 
  2. 論理設計
      - 論理データモデルへ変換
      - DBMSの制約に合わせる
      - キーやビューの設計
  3. 物理設計
      - データベースの物理構成の設計
      - データ量、データ利用頻度、運用を考慮して
- スキーマ
  - 外部スキーマ
    - 利用者、アプリケーションから見たデータ定義
  - 概念スキーマ
    - 論理的構造を定義、論理データモデルに相当
  - 内部スキーマ
    - コンピュータへの実装方法
    - 障害回復処理、セキュリティなども考慮
- E-R図
  - 実体（属性）と関連
  - 「多対多」→「１対多」＋「連関エンティティ」＋「多対１」
  - 独立エンティティ：独立した主キーで識別される
  - 依存エンティティ：外部キーが主キーの一部となっていて、外部キーで参照するエンティティが存在しないと存在できない

## 関連データベース
- ドメイン（定義域）
  - 属性が取りうる値の集合
  - スキーマの中で定義
  - `CREATE DOMAIN <属性> <データ型> CHECK <制約>`
- キー
  - スーバーキー
    - 行を一意に特定できる属性の組
  - 候補キー
    - 行を一意に特定できる属性の**最小**組
    - 複数存在する可能性
    - 「一意性制約」：同一表内に同じ値があってはいけない
    - null許容
  - 主キー
    - 候補キーから任意に選んだ１つの属性組
    - 「主キー制約」：「一意性制約」＋「NOT NULL制約」
    - 運用面から、複数の属性からなる場合、別の属性を用意して主キーとすることも考える
  - 代理キー
    - 主キーに選ばれなかった候補キー
  - 外部キー
    - 他のテーブルを参照する属性組
    - 参照先の主キーor候補キー
    - 「参照制約」：外部キーの値が被参照表に存在することを保証

## 正規化
- 関数従属
  - 属性Xの値が決まると属性Yの値が決まる
  - 部分関数従属（YがXに）
    - 属性Yが属性Xの部分集合にも関数従属する
  - 完全関数従属（YがXに）
    - 属性Yが属性Xの部分集合には関数従属しない
  - 推移的関数従属（ZがXに）
    - 属性Xの値が決まると属性Yの値が決まって、属性Zの値が決まる
    - 属性Yの値が決まると属性Xの値が決まる場合は、直接関数従属するので、推移的ではない
- 第１正規化
  - 繰り返し部分がなくなるように表を分解
- 第２正規化
  - すべての非キー属性を各候補キーに完全関数従属するように表を分解
- 第３正規化
  - 非キー属性間の関数従属がなくなるように表を分解

## SQL
- 省略

## 埋め込みSQL
- ホスト変数
  - プログラムとSQLのインターフェース
  - DBから読み出した値の格納先など
- カーソル処理
  - 複数行の操作

## データベース管理システム
- トランザクション
  - SQL処理の最小単位
- ACID特性
  - 原子性：実行結果が、コミット／ロールバックのどっちか
  - 一貫性：データの矛盾が生じないこと
  - 隔離性：実行結果の一意性、実行順序に結果が依存しない
  - 耐久性：実行結果がDBに残ること
- TPモニタ
  - ACID特性が保たれているかモニタリング
- MVCC（多版同時実行制御）
  - トランザクションの同時実行性を高める技術
- CAP定理
  - 分散型データベースシステムにおいて、「一貫性、可用性、分断耐性」のうち同時満たせるのは２つまでであるという理論